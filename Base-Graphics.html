<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>统计计算与图形</title>
  <meta name="description" content="An Introduction to Statistical Computing and Graphics with R. 统计计算和统计绘图入门">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="统计计算与图形" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="An Introduction to Statistical Computing and Graphics with R. 统计计算和统计绘图入门" />
  <meta name="github-repo" content="XiangyunHuang/ISCGwR" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="统计计算与图形" />
  
  <meta name="twitter:description" content="An Introduction to Statistical Computing and Graphics with R. 统计计算和统计绘图入门" />
  

<meta name="author" content="黄湘云">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="Statistical-Graphics-Intro.html">
<link rel="next" href="Advanced-Graphics.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">统计图形与统计计算</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> 欢迎</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#structure"><i class="fa fa-check"></i>结构</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#history"><i class="fa fa-check"></i>历史</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#colophon"><i class="fa fa-check"></i>后记</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#conventions"><i class="fa fa-check"></i>说明</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#licenses"><i class="fa fa-check"></i>授权</a></li>
</ul></li>
<li class="part"><span><b>I 统计图形</b></span></li>
<li class="chapter" data-level="" data-path="Statistical-Graphics-Intro.html"><a href="Statistical-Graphics-Intro.html"><i class="fa fa-check"></i>介绍</a></li>
<li class="chapter" data-level="2" data-path="Base-Graphics.html"><a href="Base-Graphics.html"><i class="fa fa-check"></i><b>2</b> 基础图形</a><ul>
<li class="chapter" data-level="2.1" data-path="Base-Graphics.html"><a href="Base-Graphics.html#scatter-chart"><i class="fa fa-check"></i><b>2.1</b> 散点图</a></li>
<li class="chapter" data-level="2.2" data-path="Base-Graphics.html"><a href="Base-Graphics.html#line-chart"><i class="fa fa-check"></i><b>2.2</b> 折线图</a></li>
<li class="chapter" data-level="2.3" data-path="Base-Graphics.html"><a href="Base-Graphics.html#bar-chart"><i class="fa fa-check"></i><b>2.3</b> 条形图</a></li>
<li class="chapter" data-level="2.4" data-path="Base-Graphics.html"><a href="Base-Graphics.html#hist"><i class="fa fa-check"></i><b>2.4</b> 直方图</a></li>
<li class="chapter" data-level="2.5" data-path="Base-Graphics.html"><a href="Base-Graphics.html#ecdf"><i class="fa fa-check"></i><b>2.5</b> 经验累积分布图</a></li>
<li class="chapter" data-level="2.6" data-path="Base-Graphics.html"><a href="Base-Graphics.html#qqnorm"><i class="fa fa-check"></i><b>2.6</b> QQ 正态分布图</a></li>
<li class="chapter" data-level="2.7" data-path="Base-Graphics.html"><a href="Base-Graphics.html#boxplot"><i class="fa fa-check"></i><b>2.7</b> 箱线图</a></li>
<li class="chapter" data-level="2.8" data-path="Base-Graphics.html"><a href="Base-Graphics.html#contour-lines"><i class="fa fa-check"></i><b>2.8</b> 等高线图</a></li>
<li class="chapter" data-level="2.9" data-path="Base-Graphics.html"><a href="Base-Graphics.html#perspective-plots"><i class="fa fa-check"></i><b>2.9</b> 透视图</a></li>
<li class="chapter" data-level="2.10" data-path="Base-Graphics.html"><a href="Base-Graphics.html#images"><i class="fa fa-check"></i><b>2.10</b> 热图</a></li>
<li class="chapter" data-level="2.11" data-path="Base-Graphics.html"><a href="Base-Graphics.html#dendrogram"><i class="fa fa-check"></i><b>2.11</b> 树图</a></li>
<li class="chapter" data-level="2.12" data-path="Base-Graphics.html"><a href="Base-Graphics.html#graphical-parameters"><i class="fa fa-check"></i><b>2.12</b> 图形参数</a></li>
<li class="chapter" data-level="2.13" data-path="Base-Graphics.html"><a href="Base-Graphics.html#math-annotation"><i class="fa fa-check"></i><b>2.13</b> 数学注释</a></li>
<li class="chapter" data-level="2.14" data-path="Base-Graphics.html"><a href="Base-Graphics.html#rotated-axis-labels"><i class="fa fa-check"></i><b>2.14</b> 旋转坐标抽标签</a></li>
<li class="chapter" data-level="2.15" data-path="Base-Graphics.html"><a href="Base-Graphics.html#double-y-axis"><i class="fa fa-check"></i><b>2.15</b> 双纵轴</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="Advanced-Graphics.html"><a href="Advanced-Graphics.html"><i class="fa fa-check"></i><b>3</b> 高级图形</a><ul>
<li class="chapter" data-level="3.1" data-path="Advanced-Graphics.html"><a href="Advanced-Graphics.html#grammar-of-graphics"><i class="fa fa-check"></i><b>3.1</b> ggplot2</a><ul>
<li class="chapter" data-level="3.1.1" data-path="Advanced-Graphics.html"><a href="Advanced-Graphics.html#eco"><i class="fa fa-check"></i><b>3.1.1</b> 生态</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="Advanced-Graphics.html"><a href="Advanced-Graphics.html#dynamic-graphics"><i class="fa fa-check"></i><b>3.2</b> 动态图形</a><ul>
<li class="chapter" data-level="3.2.1" data-path="Advanced-Graphics.html"><a href="Advanced-Graphics.html#grammar-of-animated-graphics"><i class="fa fa-check"></i><b>3.2.1</b> gganimate</a></li>
<li class="chapter" data-level="3.2.2" data-path="Advanced-Graphics.html"><a href="Advanced-Graphics.html#ggobi"><i class="fa fa-check"></i><b>3.2.2</b> ggobi</a></li>
<li class="chapter" data-level="3.2.3" data-path="Advanced-Graphics.html"><a href="Advanced-Graphics.html#opengl"><i class="fa fa-check"></i><b>3.2.3</b> OpenGL</a></li>
<li class="chapter" data-level="3.2.4" data-path="Advanced-Graphics.html"><a href="Advanced-Graphics.html#javascript"><i class="fa fa-check"></i><b>3.2.4</b> JavaScript</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="Published-Graphics.html"><a href="Published-Graphics.html"><i class="fa fa-check"></i><b>4</b> 出版级图形</a><ul>
<li class="chapter" data-level="4.1" data-path="Published-Graphics.html"><a href="Published-Graphics.html#pick-colors"><i class="fa fa-check"></i><b>4.1</b> 配色</a></li>
<li class="chapter" data-level="4.2" data-path="Published-Graphics.html"><a href="Published-Graphics.html#choose-fonts"><i class="fa fa-check"></i><b>4.2</b> 字体</a></li>
<li class="chapter" data-level="4.3" data-path="Published-Graphics.html"><a href="Published-Graphics.html#save-plots"><i class="fa fa-check"></i><b>4.3</b> 保存</a></li>
</ul></li>
<li class="appendix"><span><b>附录</b></span></li>
<li class="chapter" data-level="" data-path="References.html"><a href="References.html"><i class="fa fa-check"></i>参考文献</a></li>
<li class="divider"></li>
<li><a href="https://www.netlify.com/" target="blank">Published with Netlify</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">统计计算与图形</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="Base-Graphics" class="section level1">
<h1><span class="header-section-number">第 2 章</span> 基础图形</h1>
<p>数据可视化是一种重要的数据分析手段，Claus O. Wilke 目前正在写《Fundamentals of Data Visualization》，并且给出了在线网络版<a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a>。</p>
<p>1996年R语言横空出世 <span class="citation">(Ihaka and Gentleman <a href="#ref-Ross1996">1996</a>)</span> 带数学符号的注释 <span class="citation">(Murrell and Ihaka <a href="#ref-Paul2000">2000</a>)</span></p>
<p>结合统计意义和探索性数据分析介绍各种常见统计图形</p>
<p>plot 函数对象</p>
<div class="figure" style="text-align: center"><span id="fig:plot"></span>
<img src="01A-Base-Graphics_files/figure-html/plot-1.svg" alt="plot函数对象" width="70%" />
<p class="caption">
图 2.1: plot函数对象
</p>
</div>
<p>在介绍各种统计图形之前，先介绍几个绘图函数 <code>plot</code> 和 <code>text</code> 还有 <code>par</code> 参数设置， 作为最简单的开始， 尽量依次介绍其中的每个参数的含义并附上图形对比。</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">x &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">4</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2">y &lt;-<span class="st"> </span>x</a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="kw">plot</span>(x, y, <span class="dt">ann =</span> F, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">pch =</span> <span class="dv">16</span>)</a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="kw">text</span>(x, y,</a>
<a class="sourceLine" id="cb3-5" data-line-number="5">  <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;1st&quot;</span>, <span class="st">&quot;2nd&quot;</span>, <span class="st">&quot;3rd&quot;</span>, <span class="st">&quot;4th&quot;</span>),</a>
<a class="sourceLine" id="cb3-6" data-line-number="6">  <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">pos =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">1</span>), <span class="dt">offset =</span> <span class="fl">0.6</span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7">)</a></code></pre></div>
<p><img src="01A-Base-Graphics_files/figure-html/pos-1.svg" width="70%" style="display: block; margin: auto;" /></p>
<p>其中 labels， pos 都是向量化的参数</p>
<div id="scatter-chart" class="section level2">
<h2><span class="header-section-number">2.1</span> 散点图</h2>
<p>散点图（点图），抖动图（箱线图），一维的二维的</p>
<p>高亮某些点，按类别绘散点图<a href="#fn6" class="footnote-ref" id="fnref6"><sup>6</sup></a></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw">data</span>(<span class="st">&quot;iris&quot;</span>)</a>
<a class="sourceLine" id="cb4-2" data-line-number="2">pch &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">16</span>, <span class="kw">length</span>(iris<span class="op">$</span>Petal.Length))</a>
<a class="sourceLine" id="cb4-3" data-line-number="3">pch[<span class="kw">which</span>(iris<span class="op">$</span>Petal.Length <span class="op">&lt;</span><span class="st"> </span><span class="fl">1.4</span>)] &lt;-<span class="st"> </span><span class="dv">17</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="kw">stripchart</span>(Petal.Length <span class="op">~</span><span class="st"> </span>Species,</a>
<a class="sourceLine" id="cb4-5" data-line-number="5">  <span class="dt">data =</span> iris,</a>
<a class="sourceLine" id="cb4-6" data-line-number="6">  <span class="dt">vertical =</span> <span class="ot">TRUE</span>, <span class="dt">method =</span> <span class="st">&quot;jitter&quot;</span>,</a>
<a class="sourceLine" id="cb4-7" data-line-number="7">  <span class="dt">pch =</span> pch</a>
<a class="sourceLine" id="cb4-8" data-line-number="8">)</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:wrong-scatter"></span>
<img src="01A-Base-Graphics_files/figure-html/wrong-scatter-1.svg" alt="错误的散点图画法" width="70%" />
<p class="caption">
图 2.2: 错误的散点图画法
</p>
</div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw">methods</span>(stripchart)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="kw">getAnywhere</span>(stripchart.default)</a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="kw">getAnywhere</span>(xy.coords)</a></code></pre></div>
<p>pch 没有向量化 实际只是取了前三个值 16 16 17 对应于 Species 的三类</p>
<p>高亮某些点 关键是高亮的分界点是由区分意义的</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw">data</span>(<span class="st">&quot;iris&quot;</span>)</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="kw">stripchart</span>(Petal.Length <span class="op">~</span><span class="st"> </span>Species,</a>
<a class="sourceLine" id="cb6-3" data-line-number="3">  <span class="dt">data =</span> iris, <span class="dt">subset =</span> Petal.Length <span class="op">&gt;</span><span class="st"> </span><span class="fl">1.4</span>,</a>
<a class="sourceLine" id="cb6-4" data-line-number="4">  <span class="dt">vertical =</span> <span class="ot">TRUE</span>, <span class="dt">method =</span> <span class="st">&quot;jitter&quot;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">7</span>),</a>
<a class="sourceLine" id="cb6-5" data-line-number="5">  <span class="dt">pch =</span> <span class="dv">16</span></a>
<a class="sourceLine" id="cb6-6" data-line-number="6">)</a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="kw">stripchart</span>(Petal.Length <span class="op">~</span><span class="st"> </span>Species,</a>
<a class="sourceLine" id="cb6-8" data-line-number="8">  <span class="dt">data =</span> iris, <span class="dt">subset =</span> Petal.Length <span class="op">&lt;</span><span class="st"> </span><span class="fl">1.4</span>,</a>
<a class="sourceLine" id="cb6-9" data-line-number="9">  <span class="dt">vertical =</span> <span class="ot">TRUE</span>, <span class="dt">method =</span> <span class="st">&quot;jitter&quot;</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb6-10" data-line-number="10">  <span class="dt">pch =</span> <span class="dv">17</span></a>
<a class="sourceLine" id="cb6-11" data-line-number="11">)</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:right-scatter"></span>
<img src="01A-Base-Graphics_files/figure-html/right-scatter-1.svg" alt="正确的散点图" width="70%" />
<p class="caption">
图 2.3: 正确的散点图
</p>
</div>
</div>
<div id="line-chart" class="section level2">
<h2><span class="header-section-number">2.2</span> 折线图</h2>
<p>应用：时序图</p>
</div>
<div id="bar-chart" class="section level2">
<h2><span class="header-section-number">2.3</span> 条形图</h2>
<p>条形图</p>
<div class="figure" style="text-align: center"><span id="fig:ISLR"></span>
<img src="01A-Base-Graphics_files/figure-html/ISLR-1.svg" alt="条形图" width="70%" />
<p class="caption">
图 2.4: 条形图
</p>
</div>
<p>应用：
自协方差、自相关、偏自相关、协相关和协方差图，</p>
</div>
<div id="hist" class="section level2">
<h2><span class="header-section-number">2.4</span> 直方图</h2>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw">with</span>(<span class="dt">data =</span> faithful, {</a>
<a class="sourceLine" id="cb7-2" data-line-number="2">  <span class="kw">hist</span>(eruptions, <span class="kw">seq</span>(<span class="fl">1.6</span>, <span class="fl">5.2</span>, <span class="fl">0.2</span>), <span class="dt">prob =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb7-3" data-line-number="3">  <span class="kw">lines</span>(<span class="kw">density</span>(eruptions, <span class="dt">bw =</span> <span class="fl">0.1</span>))</a>
<a class="sourceLine" id="cb7-4" data-line-number="4">  <span class="kw">rug</span>(eruptions) <span class="co"># show the actual data points</span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5">})</a></code></pre></div>
<p><img src="01A-Base-Graphics_files/figure-html/eruptions-1.svg" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="ecdf" class="section level2">
<h2><span class="header-section-number">2.5</span> 经验累积分布图</h2>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw">with</span>(<span class="dt">data =</span> faithful, {</a>
<a class="sourceLine" id="cb8-2" data-line-number="2">  long &lt;-<span class="st"> </span>eruptions[eruptions <span class="op">&gt;</span><span class="st"> </span><span class="dv">3</span>]</a>
<a class="sourceLine" id="cb8-3" data-line-number="3">  <span class="kw">plot</span>(<span class="kw">ecdf</span>(long), <span class="dt">do.points =</span> <span class="ot">FALSE</span>, <span class="dt">verticals =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb8-4" data-line-number="4">  x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">3</span>, <span class="fl">5.4</span>, <span class="fl">0.01</span>)</a>
<a class="sourceLine" id="cb8-5" data-line-number="5">  <span class="kw">lines</span>(x, <span class="kw">pnorm</span>(x, <span class="dt">mean =</span> <span class="kw">mean</span>(long), <span class="dt">sd =</span> <span class="kw">sqrt</span>(<span class="kw">var</span>(long))), <span class="dt">lty =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb8-6" data-line-number="6">})</a></code></pre></div>
<p><img src="01A-Base-Graphics_files/figure-html/faithful-1.svg" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="qqnorm" class="section level2">
<h2><span class="header-section-number">2.6</span> QQ 正态分布图</h2>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw">with</span>(<span class="dt">data =</span> faithful, {</a>
<a class="sourceLine" id="cb9-2" data-line-number="2">  long &lt;-<span class="st"> </span>eruptions[eruptions <span class="op">&gt;</span><span class="st"> </span><span class="dv">3</span>]</a>
<a class="sourceLine" id="cb9-3" data-line-number="3">  <span class="kw">par</span>(<span class="dt">pty =</span> <span class="st">&quot;s&quot;</span>) <span class="co"># arrange for a square figure region</span></a>
<a class="sourceLine" id="cb9-4" data-line-number="4">  <span class="kw">qqnorm</span>(long)</a>
<a class="sourceLine" id="cb9-5" data-line-number="5">  <span class="kw">qqline</span>(long)</a>
<a class="sourceLine" id="cb9-6" data-line-number="6">})</a></code></pre></div>
<p><img src="01A-Base-Graphics_files/figure-html/faithful-eruptions-1.svg" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="boxplot" class="section level2">
<h2><span class="header-section-number">2.7</span> 箱线图</h2>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">A &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">79.98</span>, <span class="fl">80.04</span>, <span class="fl">80.02</span>, <span class="fl">80.04</span>, <span class="fl">80.03</span>, <span class="fl">80.03</span>, <span class="fl">80.04</span>, <span class="fl">79.97</span>,</a>
<a class="sourceLine" id="cb10-2" data-line-number="2">       <span class="fl">80.05</span>, <span class="fl">80.03</span>, <span class="fl">80.02</span>, <span class="dv">80</span>, <span class="fl">80.02</span>)</a>
<a class="sourceLine" id="cb10-3" data-line-number="3">B &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">80.02</span>, <span class="fl">79.94</span>, <span class="fl">79.98</span>, <span class="fl">79.97</span>, <span class="fl">79.97</span>, <span class="fl">80.03</span>, <span class="fl">79.95</span>, <span class="fl">79.97</span>)</a>
<a class="sourceLine" id="cb10-4" data-line-number="4"><span class="kw">boxplot</span>(A, B)</a></code></pre></div>
<p><img src="01A-Base-Graphics_files/figure-html/boxplot-1.svg" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw">with</span>(<span class="dt">data =</span> iris, {</a>
<a class="sourceLine" id="cb11-2" data-line-number="2">  op &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>), <span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="fl">.5</span>))</a>
<a class="sourceLine" id="cb11-3" data-line-number="3">  <span class="kw">plot</span>(Sepal.Length <span class="op">~</span><span class="st"> </span>Species)</a>
<a class="sourceLine" id="cb11-4" data-line-number="4">  <span class="kw">plot</span>(Sepal.Width <span class="op">~</span><span class="st"> </span>Species)</a>
<a class="sourceLine" id="cb11-5" data-line-number="5">  <span class="kw">plot</span>(Petal.Length <span class="op">~</span><span class="st"> </span>Species)</a>
<a class="sourceLine" id="cb11-6" data-line-number="6">  <span class="kw">plot</span>(Petal.Width <span class="op">~</span><span class="st"> </span>Species)</a>
<a class="sourceLine" id="cb11-7" data-line-number="7">  <span class="kw">par</span>(op)</a>
<a class="sourceLine" id="cb11-8" data-line-number="8">  <span class="kw">mtext</span>(<span class="st">&quot;Edgar Anderson&#39;s Iris Data&quot;</span>, <span class="dt">side =</span> <span class="dv">3</span>, <span class="dt">line =</span> <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb11-9" data-line-number="9">})</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:iris"></span>
<img src="01A-Base-Graphics_files/figure-html/iris-1.svg" alt="安德森的鸢尾花数据" width="70%" />
<p class="caption">
图 2.5: 安德森的鸢尾花数据
</p>
</div>
</div>
<div id="contour-lines" class="section level2">
<h2><span class="header-section-number">2.8</span> 等高线图</h2>
<p>contour</p>
</div>
<div id="perspective-plots" class="section level2">
<h2><span class="header-section-number">2.9</span> 透视图</h2>
<p>persp
多元分布函数图像</p>
</div>
<div id="images" class="section level2">
<h2><span class="header-section-number">2.10</span> 热图</h2>
<p>image</p>
<p>应用：heatmap, raster 图像</p>
</div>
<div id="dendrogram" class="section level2">
<h2><span class="header-section-number">2.11</span> 树图</h2>
<p>dendrogram</p>
<p>层次聚类/分类/回归树</p>
</div>
<div id="graphical-parameters" class="section level2">
<h2><span class="header-section-number">2.12</span> 图形参数</h2>
<p><code>par()</code> 图形版面设置</p>
</div>
<div id="math-annotation" class="section level2">
<h2><span class="header-section-number">2.13</span> 数学注释</h2>
<p>数学符号注释，图<a href="Base-Graphics.html#fig:math-annotation">2.6</a> 自定义坐标轴 <span class="citation">(Murrell and Ihaka <a href="#ref-Paul2000">2000</a>)</span>。</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="co"># 自定义坐标轴</span></a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="kw">plot</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">1e6</span>), <span class="kw">c</span>(<span class="op">-</span>pi, pi), <span class="dt">type =</span> <span class="st">&quot;n&quot;</span>, </a>
<a class="sourceLine" id="cb12-3" data-line-number="3">     <span class="dt">axes =</span> <span class="ot">FALSE</span>, <span class="dt">ann =</span> <span class="ot">FALSE</span>, <span class="dt">log =</span> <span class="st">&quot;x&quot;</span>)</a>
<a class="sourceLine" id="cb12-4" data-line-number="4"><span class="kw">axis</span>(<span class="dv">1</span>, <span class="dt">at =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">1e2</span>, <span class="fl">1e4</span>, <span class="fl">1e6</span>), </a>
<a class="sourceLine" id="cb12-5" data-line-number="5">     <span class="dt">labels =</span> <span class="kw">expression</span>(<span class="dv">1</span>, <span class="dv">10</span><span class="op">^</span><span class="dv">2</span>, <span class="dv">10</span><span class="op">^</span><span class="dv">4</span>, <span class="dv">10</span><span class="op">^</span><span class="dv">6</span>))</a>
<a class="sourceLine" id="cb12-6" data-line-number="6"><span class="kw">axis</span>(<span class="dv">2</span>, <span class="dt">at =</span> <span class="kw">c</span>(<span class="op">-</span>pi, <span class="op">-</span>pi <span class="op">/</span><span class="st"> </span><span class="dv">2</span>, <span class="dv">0</span>, pi <span class="op">/</span><span class="st"> </span><span class="dv">2</span>, pi), </a>
<a class="sourceLine" id="cb12-7" data-line-number="7">     <span class="dt">labels =</span> <span class="kw">expression</span>(<span class="op">-</span>pi, <span class="op">-</span>pi <span class="op">/</span><span class="st"> </span><span class="dv">2</span>, <span class="dv">0</span>, pi <span class="op">/</span><span class="st"> </span><span class="dv">2</span>, pi))</a>
<a class="sourceLine" id="cb12-8" data-line-number="8"><span class="kw">text</span>(<span class="fl">1e3</span>, <span class="dv">0</span>, <span class="kw">expression</span>(<span class="kw">italic</span>(<span class="st">&quot;Customized Axes&quot;</span>)))</a>
<a class="sourceLine" id="cb12-9" data-line-number="9"><span class="kw">box</span>()</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:math-annotation"></span>
<img src="01A-Base-Graphics_files/figure-html/math-annotation-1.svg" alt="Creating Customized Axes With Suitable Annotation" width="70%" />
<p class="caption">
图 2.6: Creating Customized Axes With Suitable Annotation
</p>
</div>
</div>
<div id="rotated-axis-labels" class="section level2">
<h2><span class="header-section-number">2.14</span> 旋转坐标抽标签</h2>
<p>旋转坐标抽标签的例子来自手册《R FAQ》的第7章第27个问题 <span class="citation">(Hornik <a href="#ref-R-FAQ">2017</a>)</span>，在基础图形中，旋转坐标轴标签需要 <code>text()</code> 而不是 <code>mtext()</code>，因为后者不支持<code>par(&quot;srt&quot;)</code></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="co">## Increase bottom margin to make room for rotated labels</span></a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">4</span>, <span class="fl">.5</span>, <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb13-3" data-line-number="3"><span class="co">## Create plot with no x axis and no x axis label</span></a>
<a class="sourceLine" id="cb13-4" data-line-number="4"><span class="kw">plot</span>(<span class="dv">1</span> <span class="op">:</span><span class="st"> </span><span class="dv">8</span>, <span class="dt">xaxt =</span> <span class="st">&quot;n&quot;</span>,  <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb13-5" data-line-number="5"><span class="co">## Set up x axis with tick marks alone</span></a>
<a class="sourceLine" id="cb13-6" data-line-number="6"><span class="kw">axis</span>(<span class="dv">1</span>, <span class="dt">labels =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb13-7" data-line-number="7"><span class="co">## Create some text labels</span></a>
<a class="sourceLine" id="cb13-8" data-line-number="8">labels &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;Label&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">8</span>, <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>)</a>
<a class="sourceLine" id="cb13-9" data-line-number="9"><span class="co">## Plot x axis labels at default tick marks</span></a>
<a class="sourceLine" id="cb13-10" data-line-number="10"><span class="kw">text</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">8</span>, <span class="kw">par</span>(<span class="st">&quot;usr&quot;</span>)[<span class="dv">3</span>] <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span>, <span class="dt">srt =</span> <span class="dv">45</span>, <span class="dt">adj =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb13-11" data-line-number="11">     <span class="dt">labels =</span> labels, <span class="dt">xpd =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb13-12" data-line-number="12"><span class="co">## Plot x axis label at line 6 (of 7)</span></a>
<a class="sourceLine" id="cb13-13" data-line-number="13"><span class="kw">mtext</span>(<span class="dt">side =</span> <span class="dv">1</span>, <span class="dt">text =</span> <span class="st">&quot;X Axis Label&quot;</span>, <span class="dt">line =</span> <span class="dv">4</span>)</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:rotate-axis-labels"></span>
<img src="01A-Base-Graphics_files/figure-html/rotate-axis-labels-1.svg" alt="旋转坐标轴标签" width="70%" />
<p class="caption">
图 2.7: 旋转坐标轴标签
</p>
</div>
<p><code>srt = 45</code> 表示文本旋转角度， <code>xpd = TRUE</code> 允许文本越出绘图区域，<code>adj = 1</code> to place the right end of text at the tick marks；You can adjust the value of the 0.5 offset as required to move the axis labels up or down relative to the x axis.</p>
</div>
<div id="double-y-axis" class="section level2">
<h2><span class="header-section-number">2.15</span> 双纵轴</h2>
<p>How to plot multiple time series plots in a grid, where each plot has two y axes? <a href="https://stackoverflow.com/questions/52082801" class="uri">https://stackoverflow.com/questions/52082801</a></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb14-2" data-line-number="2">dd &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</a>
<a class="sourceLine" id="cb14-3" data-line-number="3">  <span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">11</span>, <span class="dt">y =</span> <span class="kw">c</span>(<span class="kw">rnorm</span>(<span class="dv">22</span>),<span class="kw">rpois</span>(<span class="dv">22</span>,<span class="dv">5</span>)),</a>
<a class="sourceLine" id="cb14-4" data-line-number="4">  <span class="dt">id =</span> <span class="kw">gl</span>(<span class="dv">2</span>, <span class="dv">11</span>, <span class="dt">labels =</span> <span class="kw">paste0</span>(<span class="st">&quot;ser&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>)),</a>
<a class="sourceLine" id="cb14-5" data-line-number="5">  <span class="dt">panel =</span> <span class="kw">gl</span>(<span class="dv">2</span>, <span class="dv">22</span>, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;pois&quot;</span>))</a>
<a class="sourceLine" id="cb14-6" data-line-number="6">)</a>
<a class="sourceLine" id="cb14-7" data-line-number="7"><span class="co"># 设置左手刻度为 norm 右手刻度为 pois</span></a>
<a class="sourceLine" id="cb14-8" data-line-number="8"><span class="kw">ggplot</span>(dd, <span class="kw">aes</span>(x, y, <span class="dt">col =</span> panel)) <span class="op">+</span></a>
<a class="sourceLine" id="cb14-9" data-line-number="9"><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb14-10" data-line-number="10"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>id) <span class="op">+</span></a>
<a class="sourceLine" id="cb14-11" data-line-number="11"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">sec.axis =</span> <span class="kw">sec_axis</span>(<span class="op">~</span>.))</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:two-axis"></span>
<img src="01A-Base-Graphics_files/figure-html/two-axis-1.svg" alt="双纵轴时间序列" width="70%" />
<p class="caption">
图 2.8: 双纵轴时间序列
</p>
</div>

</div>
</div>
<h3>参考文献</h3>
<div id="refs" class="references">
<div id="ref-Ross1996">
<p>Ihaka, Ross, and Robert Gentleman. 1996. “R: A Language for Data Analysis and Graphics.” <em>Journal of Computational and Graphical Statistics</em> 5 (3): 299–314.</p>
</div>
<div id="ref-Paul2000">
<p>Murrell, Paul, and Ross Ihaka. 2000. “An Approach to Providing Mathematical Annotation in Plots.” <em>Journal of Computational and Graphical Statistics</em> 9 (3): 582–99.</p>
</div>
<div id="ref-R-FAQ">
<p>Hornik, Kurt. 2017. “R FAQ.” <a href="https://CRAN.R-project.org/doc/FAQ/R-FAQ.html" class="uri">https://CRAN.R-project.org/doc/FAQ/R-FAQ.html</a>.</p>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="5">
<li id="fn5"><p><a href="https://serialmentor.com/dataviz/" class="uri">https://serialmentor.com/dataviz/</a><a href="Base-Graphics.html#fnref5" class="footnote-back">↩</a></p></li>
<li id="fn6"><p><a href="https://stackoverflow.com/questions/51804892/use-vectorized-plotting-arguments-when-plotting-by-factor-in-r" class="uri">https://stackoverflow.com/questions/51804892/use-vectorized-plotting-arguments-when-plotting-by-factor-in-r</a><a href="Base-Graphics.html#fnref6" class="footnote-back">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="Statistical-Graphics-Intro.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="Advanced-Graphics.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/XiangyunHuang/ISCGwR/edit/master/01A-Base-Graphics.Rmd",
"text": "编辑"
},
"download": ["ISCGwR.pdf", "ISCGwR.epub", "ISCGwR.mobi"],
"toc": {
"collapse": "none"
}
});
});
</script>

</body>

</html>
