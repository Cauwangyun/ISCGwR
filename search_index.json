[
["index.html", "统计计算与图形 第 1 章 欢迎 结构 历史 后记 说明 授权", " 统计计算与图形 黄湘云 2018-09-19 11:53:12 CST 第 1 章 欢迎 R 软件主要用于统计计算和统计绘图， 因其提供了完整的绘图系统， 实现了大量的统计方法， 而且相比于其他统计软件，具有免费和更新快的特点，在当今数据时代浪潮下，占有一席之地。 Markdown 是一个文本标记语言。 欢迎来到 R 语言的世界， 写点关于发展历史等容易吸引人的东西， 让读者有继续看下去的欲望。 结构 介绍书籍写作工具，写作风格设定，结构说明，R语言介绍1 图 1.1: R语言 历史 历史数据分析 # 获取数据 pdb &lt;- tools::CRAN_package_db() pdb &lt;- pdb[,c(&quot;Package&quot;,&quot;Published&quot;)] # pdb &lt;- readRDS(file = &quot;data/pdb.RDS&quot;) library(ggplot2) ggplot(pdb[,c(&quot;Package&quot;,&quot;Published&quot;)], aes( as.Date(Published) ) ) + geom_bar(color = &#39;springgreen4&#39;) + geom_line(data = data.frame( date = as.Date( c(&quot;2011-01-01&quot;,&quot;2012-10-20&quot;) ), count = c(130,148)), aes(x = date , y = count), arrow = arrow(angle = 15, length = unit(0.15, &quot;inches&quot;))) + annotate(&quot;text&quot;, x = as.Date(&quot;2010-11-01&quot;), y = 128, label = &quot;(2012-10-29,148)&quot;) + scale_x_date(date_breaks = &quot;1 year&quot;,date_labels = &quot;%Y&quot;) + labs(x = &quot;Published Date&quot; ,y = &quot;Count&quot; ) + theme_minimal() 图 1.2: 有趣的是在2012年10月29日更新的R包多达148个 图 1.3: R包发布量变化趋势 R语言进入到各方各面 如何重复本书，写作工具，如何提交 PR，参与写作 益辉维护的 R Markdown 生态及其它 R 包，如图 1.4 图 1.4: 益辉在 Github 上维护的 R 包2 后记 这本书是在 RStudio 内用 R Markdown (Xie, Allaire, and Grolemund 2018) 写的， Git 控制版本， bookdown (Xie 2016) 组织章节， knitr (Xie 2015) 调用各类编程语言或解释或编译代码块，将执行结果返回到 R Markdown 文件， Pandoc 再将其转化为 Markdown 和 HTML 文档，进一步转化为 PDF 格式文档则需要 TinyTeX 发行版3。 图 1.5: 工作流程图4 这个网站是通过 Travis-CI 把编译结果（即 _book 目录）推送到 Netlify 实现部署。在 Travis-CI 和 Netlify 都与 Github 绑定的情况下，源代码一发生改变就会触发编译，编译成功就会自动部署，这个过程即持续集成和连续部署，你正在阅读的版本是 2018-09-19 在 Travis 上构建的。 如果编译和部署成功，你会看到一个绿色的指示器，否则指示器显示红色。 说明 Alegreya 罗马体显示正文，AlegreyaSans 等线体显示数字，sourcecodepro 等宽体显示代码，Alegreya 字体源文件见 https://github.com/huertatipografica/ 和样式见 https://huertatipografica.com/en，我们可以通过安装 LaTeX 包 alegreya 获得。R 包名称在文中以粗体显示，代码块输出用 #&gt; 表示，以区分普通的代码注释 # 绘图使用的中文字体是思源宋体和思源黑体， 由 showtext 包安装和调用，tikzDevice 和 fontcm 处理其中的数学公式，xkcd 设置漫画手写体风格。 我的写作环境是 VBox + Ubuntu 16.04.4 Server + PuTTY + Xming，如图 1.6 所示。 图 1.6: 远程办公四剑客 书籍生成过程中，R 进程和 Pandoc 版本信息如下： xfun::session_info() #&gt; R version 3.5.0 (2017-01-27) #&gt; Platform: x86_64-pc-linux-gnu (64-bit) #&gt; Running under: Ubuntu 14.04.5 LTS #&gt; #&gt; Locale: #&gt; LC_CTYPE=en_US.UTF-8 LC_NUMERIC=C #&gt; LC_TIME=en_US.UTF-8 LC_COLLATE=en_US.UTF-8 #&gt; LC_MONETARY=en_US.UTF-8 LC_MESSAGES=en_US.UTF-8 #&gt; LC_PAPER=en_US.UTF-8 LC_NAME=C #&gt; LC_ADDRESS=C LC_TELEPHONE=C #&gt; LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C #&gt; #&gt; Package version: #&gt; assertthat_0.2.0 backports_1.1.2 base64enc_0.1.3 #&gt; BH_1.66.0.1 bookdown_0.7 cli_1.0.0 #&gt; codetools_0.2-15 colorspace_1.3-2 compiler_3.5.0 #&gt; crayon_1.3.4 curl_3.2 digest_0.6.17 #&gt; evaluate_0.11 fansi_0.3.0 gdtools_0.1.7 #&gt; ggplot2_3.0.0 glue_1.3.0 graphics_3.5.0 #&gt; grDevices_3.5.0 grid_3.5.0 gtable_0.2.0 #&gt; highr_0.7 htmltools_0.3.6 jsonlite_1.5 #&gt; knitr_1.20 labeling_0.3 lattice_0.20.35 #&gt; lazyeval_0.2.1 magrittr_1.5 markdown_0.8 #&gt; MASS_7.3.49 Matrix_1.2.14 methods_3.5.0 #&gt; mgcv_1.8.23 mime_0.5 munsell_0.5.0 #&gt; nlme_3.1.137 pillar_1.3.0 plyr_1.8.4 #&gt; R6_2.2.2 RColorBrewer_1.1.2 Rcpp_0.12.18 #&gt; reshape2_1.4.3 rlang_0.2.2 rmarkdown_1.10 #&gt; rprojroot_1.3-2 scales_1.0.0 stats_3.5.0 #&gt; stringi_1.2.4 stringr_1.3.1 svglite_1.2.1 #&gt; tibble_1.4.2 tinytex_0.8 tools_3.5.0 #&gt; utf8_1.1.4 utils_3.5.0 viridisLite_0.3.0 #&gt; withr_2.1.2 xfun_0.3 yaml_2.2.0 rmarkdown::pandoc_version() #&gt; [1] &#39;2.3&#39; 授权 本书采用 知识共享署名-非商业性使用-禁止演绎 4.0 国际许可协议 许可，请君自重，别没事儿拿去传个什么新浪爱问、百度文库以及 XX 经济论坛，项目中代码使用 MIT 协议 开源 参考文献 "],
["Statistical-Graphics-Intro.html", "介绍", " 介绍 介绍这部分讲什么内容，如何展开 "],
["Base-Graphics.html", "第 2 章 基础图形 2.1 散点图 2.2 折线图 2.3 条形图 2.4 直方图 2.5 经验累积分布图 2.6 QQ 正态分布图 2.7 箱线图 2.8 等高线图 2.9 透视图 2.10 热图 2.11 树图 2.12 图形参数 2.13 数学注释 2.14 旋转坐标抽标签 2.15 双纵轴", " 第 2 章 基础图形 数据可视化是一种重要的数据分析手段，Claus O. Wilke 目前正在写《Fundamentals of Data Visualization》，并且给出了在线网络版5。 1996年R语言横空出世 (Ihaka and Gentleman 1996) 带数学符号的注释 (Murrell and Ihaka 2000) 结合统计意义和探索性数据分析介绍各种常见统计图形 plot 函数对象 图 2.1: plot函数对象 在介绍各种统计图形之前，先介绍几个绘图函数 plot 和 text 还有 par 参数设置， 作为最简单的开始， 尽量依次介绍其中的每个参数的含义并附上图形对比。 x &lt;- 1:4 y &lt;- x plot(x, y, ann = F, col = &quot;blue&quot;, pch = 16) text(x, y, labels = c(&quot;1st&quot;, &quot;2nd&quot;, &quot;3rd&quot;, &quot;4th&quot;), col = &quot;red&quot;, pos = c(3, 4, 4, 1), offset = 0.6 ) 其中 labels， pos 都是向量化的参数 2.1 散点图 散点图（点图），抖动图（箱线图），一维的二维的 高亮某些点，按类别绘散点图6 data(&quot;iris&quot;) pch &lt;- rep(16, length(iris$Petal.Length)) pch[which(iris$Petal.Length &lt; 1.4)] &lt;- 17 stripchart(Petal.Length ~ Species, data = iris, vertical = TRUE, method = &quot;jitter&quot;, pch = pch ) 图 2.2: 错误的散点图画法 methods(stripchart) getAnywhere(stripchart.default) getAnywhere(xy.coords) pch 没有向量化 实际只是取了前三个值 16 16 17 对应于 Species 的三类 高亮某些点 关键是高亮的分界点是由区分意义的 data(&quot;iris&quot;) stripchart(Petal.Length ~ Species, data = iris, subset = Petal.Length &gt; 1.4, vertical = TRUE, method = &quot;jitter&quot;, ylim = c(1, 7), pch = 16 ) stripchart(Petal.Length ~ Species, data = iris, subset = Petal.Length &lt; 1.4, vertical = TRUE, method = &quot;jitter&quot;, add = TRUE, pch = 17 ) 图 2.3: 正确的散点图 2.2 折线图 应用：时序图 2.3 条形图 条形图 图 2.4: 条形图 应用： 自协方差、自相关、偏自相关、协相关和协方差图， 2.4 直方图 with(data = faithful, { hist(eruptions, seq(1.6, 5.2, 0.2), prob = TRUE) lines(density(eruptions, bw = 0.1)) rug(eruptions) # show the actual data points }) 2.5 经验累积分布图 with(data = faithful, { long &lt;- eruptions[eruptions &gt; 3] plot(ecdf(long), do.points = FALSE, verticals = TRUE) x &lt;- seq(3, 5.4, 0.01) lines(x, pnorm(x, mean = mean(long), sd = sqrt(var(long))), lty = 3) }) 2.6 QQ 正态分布图 with(data = faithful, { long &lt;- eruptions[eruptions &gt; 3] par(pty = &quot;s&quot;) # arrange for a square figure region qqnorm(long) qqline(long) }) 2.7 箱线图 A &lt;- c(79.98, 80.04, 80.02, 80.04, 80.03, 80.03, 80.04, 79.97, 80.05, 80.03, 80.02, 80, 80.02) B &lt;- c(80.02, 79.94, 79.98, 79.97, 79.97, 80.03, 79.95, 79.97) boxplot(A, B) with(data = iris, { op &lt;- par(mfrow = c(2, 2), mar = c(4, 4, 2, .5)) plot(Sepal.Length ~ Species) plot(Sepal.Width ~ Species) plot(Petal.Length ~ Species) plot(Petal.Width ~ Species) par(op) mtext(&quot;Edgar Anderson&#39;s Iris Data&quot;, side = 3, line = 4) }) 图 2.5: 安德森的鸢尾花数据 2.8 等高线图 contour 2.9 透视图 persp 多元分布函数图像 2.10 热图 image 应用：heatmap, raster 图像 2.11 树图 dendrogram 层次聚类/分类/回归树 2.12 图形参数 par() 图形版面设置 2.13 数学注释 数学符号注释，图2.6 自定义坐标轴 (Murrell and Ihaka 2000)。 # 自定义坐标轴 plot(c(1, 1e6), c(-pi, pi), type = &quot;n&quot;, axes = FALSE, ann = FALSE, log = &quot;x&quot;) axis(1, at = c(1, 1e2, 1e4, 1e6), labels = expression(1, 10^2, 10^4, 10^6)) axis(2, at = c(-pi, -pi / 2, 0, pi / 2, pi), labels = expression(-pi, -pi / 2, 0, pi / 2, pi)) text(1e3, 0, expression(italic(&quot;Customized Axes&quot;))) box() 图 2.6: Creating Customized Axes With Suitable Annotation 2.14 旋转坐标抽标签 旋转坐标抽标签的例子来自手册《R FAQ》的第7章第27个问题 (Hornik 2017)，在基础图形中，旋转坐标轴标签需要 text() 而不是 mtext()，因为后者不支持par(&quot;srt&quot;) ## Increase bottom margin to make room for rotated labels par(mar = c(5, 4, .5, 2) + 0.1) ## Create plot with no x axis and no x axis label plot(1 : 8, xaxt = &quot;n&quot;, xlab = &quot;&quot;) ## Set up x axis with tick marks alone axis(1, labels = FALSE) ## Create some text labels labels &lt;- paste(&quot;Label&quot;, 1:8, sep = &quot; &quot;) ## Plot x axis labels at default tick marks text(1:8, par(&quot;usr&quot;)[3] - 0.5, srt = 45, adj = 1, labels = labels, xpd = TRUE) ## Plot x axis label at line 6 (of 7) mtext(side = 1, text = &quot;X Axis Label&quot;, line = 4) 图 2.7: 旋转坐标轴标签 srt = 45 表示文本旋转角度， xpd = TRUE 允许文本越出绘图区域，adj = 1 to place the right end of text at the tick marks；You can adjust the value of the 0.5 offset as required to move the axis labels up or down relative to the x axis. 2.15 双纵轴 How to plot multiple time series plots in a grid, where each plot has two y axes? https://stackoverflow.com/questions/52082801 library(ggplot2) dd &lt;- data.frame( x = 1:11, y = c(rnorm(22),rpois(22,5)), id = gl(2, 11, labels = paste0(&quot;ser&quot;, 1:2)), panel = gl(2, 22, labels = c(&quot;norm&quot;,&quot;pois&quot;)) ) # 设置左手刻度为 norm 右手刻度为 pois ggplot(dd, aes(x, y, col = panel)) + geom_line() + facet_wrap(~id) + scale_y_continuous(sec.axis = sec_axis(~.)) 图 2.8: 双纵轴时间序列 参考文献 "],
["Advanced-Graphics.html", "第 3 章 高级图形 3.1 ggplot2 3.2 动态图形", " 第 3 章 高级图形 2010 年 Hadley基于图形语法开发了 ggplot 包，随后一直保持维护和开发，在2015年进行重构，推出ggplot2，经过几年的发展，现已进入软件开发的稳定阶段。 图 3.1: Hadley Wickham 的帅照 介绍 grid 绘图系统，特别是 ggplot2 包 图形语法，图层，点线，映射，统计 3.1 ggplot2 图形语法 3.1.1 生态 grep(&#39;^(gg)&#39;, .packages(T), value = TRUE) #&gt; [1] &quot;ggplot2&quot; 3.2 动态图形 一类由静态图形合成为 gif, avi, svg 等，一类面向特定输出设备的动态图形，基于JavaScript库的交互图形，基于 OpenGL/ggobi/asymptote 的真三维图形 3.2.1 gganimate 与此类似的还有 mapmate 3.2.2 ggobi 3.2.3 OpenGL 3.2.4 JavaScript "],
["Published-Graphics.html", "第 4 章 出版级图形 4.1 配色 4.2 字体 4.3 保存", " 第 4 章 出版级图形 要达到出版级的专业图形，我们需要从配色、字体等方面再下功夫 4.1 配色 配色是快速提升图片美感的捷径，主要介绍一下基础调色板， colorspace，RcolorBrewer 和 viridis 三个用于配色的 R 包。除了上述要求外，还应在字体和图形质量上考虑 调制两个色板 n &lt;- 16 # Colors from https://github.com/johannesbjork/LaCroixColoR color_pal &lt;- c(&quot;#FF3200&quot;, &quot;#E9A17C&quot;, &quot;#E9E4A6&quot;, &quot;#1BB6AF&quot;, &quot;#0076BB&quot;, &quot;#172869&quot;) color_pals_1 &lt;- (grDevices::colorRampPalette(color_pal))(n) scales::show_col(colours = color_pals_1) # colors in colortools from http://www.gastonsanchez.com/ fish_pal &lt;- c(&quot;#69D2E7&quot;, &quot;#6993E7&quot;, &quot;#7E69E7&quot;, &quot;#BD69E7&quot;, &quot;#E769D2&quot;, &quot;#E76993&quot;, &quot;#E77E69&quot;, &quot;#E7BD69&quot;, &quot;#D2E769&quot;, &quot;#93E769&quot;, &quot;#69E77E&quot;, &quot;#69E7BD&quot;) color_pals_2 &lt;- (grDevices::colorRampPalette(fish_pal))(n) scales::show_col(colours = color_pals_2) 图 4.1: 调色板 4.2 字体 xkcd 等字体 font_add_google(&quot;Alegreya Sans&quot;, &quot;aleg&quot;) font_add_google(&quot;Source Code Pro&quot;, &quot;sourcecodepro&quot;) font_add_google(&quot;Source Sans Pro&quot;, &quot;sourcesanspro&quot;) font_add_google(&quot;Source Serif Pro&quot;, &quot;sourceserifpro&quot;) font_add_google(&quot;Roboto&quot;, &quot;roboto&quot;) # Ubuntu Ubuntu Mono Ubuntu Condensed # library(showtext,quietly = TRUE) # showtext.auto() # pdf(&quot;google-fonts.pdf&quot;) # font_add_google(&quot;Alegreya Sans&quot;, &quot;aleg&quot;) par(family = &quot;serif&quot;) plot(0:5,0:5, type=&quot;n&quot;) text(1:4, 1:4, &quot;Serif&quot;, font=1:4, cex = 2) par(family = &quot;sans&quot;) plot(0:5,0:5, type=&quot;n&quot;) text(1:4, 1:4, &quot;Sans&quot;, font=1:4, cex = 2) # dev.off() 图 4.2: 两种字体 4.3 保存 图形设备，抗锯齿，颜色模式LAB，RGB，CMYK 适应展示设备需要 embedFonts(file = &quot;google-fonts-ex.pdf&quot;,outfile = &quot;google-fonts-ex-embed.pdf&quot;) 另外一个方法就是使用 cairo_pdf 而不是 pdf "],
["References.html", "参考文献", " 参考文献 "]
]
